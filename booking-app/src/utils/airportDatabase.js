// Database lokasi populer sebagai fallback
export const popularLocations = [
  // Indonesia
  {
    id: "JKT1",
    name: "Jakarta - Semua Bandara",
    iataCode: "JKT",
    cityName: "Jakarta",
    countryName: "Indonesia",
  },
  {
    id: "CGK1",
    name: "Jakarta - Soekarno-Hatta International Airport",
    iataCode: "CGK",
    cityName: "Jakarta",
    countryName: "Indonesia",
  },
  {
    id: "HLP1",
    name: "Jakarta - Halim Perdanakusuma Airport",
    iataCode: "HLP",
    cityName: "Jakarta",
    countryName: "Indonesia",
  },
  {
    id: "DPS1",
    name: "Denpasar - Ngurah Rai International Airport",
    iataCode: "DPS",
    cityName: "Denpasar",
    countryName: "Indonesia",
  },
  {
    id: "SUB1",
    name: "Surabaya - Juanda International Airport",
    iataCode: "SUB",
    cityName: "Surabaya",
    countryName: "Indonesia",
  },
  {
    id: "BTH1",
    name: "Batam - Hang Nadim International Airport",
    iataCode: "BTH",
    cityName: "Batam",
    countryName: "Indonesia",
  },
  {
    id: "UPG1",
    name: "Makassar - Sultan Hasanuddin Airport",
    iataCode: "UPG",
    cityName: "Makassar",
    countryName: "Indonesia",
  },
  {
    id: "KNO1",
    name: "Medan - Kualanamu International Airport",
    iataCode: "KNO",
    cityName: "Medan",
    countryName: "Indonesia",
  },
  {
    id: "JOG1",
    name: "Yogyakarta - Adisucipto International Airport",
    iataCode: "JOG",
    cityName: "Yogyakarta",
    countryName: "Indonesia",
  },
  {
    id: "YIA1",
    name: "Yogyakarta - Yogyakarta International Airport",
    iataCode: "YIA",
    cityName: "Yogyakarta",
    countryName: "Indonesia",
  },
  {
    id: "BPN1",
    name: "Balikpapan - Sultan Aji Muhammad Sulaiman Airport",
    iataCode: "BPN",
    cityName: "Balikpapan",
    countryName: "Indonesia",
  },
  {
    id: "PLM1",
    name: "Palembang - Sultan Mahmud Badaruddin II Airport",
    iataCode: "PLM",
    cityName: "Palembang",
    countryName: "Indonesia",
  },
  {
    id: "BDO1",
    name: "Bandung - Husein Sastranegara Airport",
    iataCode: "BDO",
    cityName: "Bandung",
    countryName: "Indonesia",
  },
  {
    id: "SRG1",
    name: "Semarang - Ahmad Yani International Airport",
    iataCode: "SRG",
    cityName: "Semarang",
    countryName: "Indonesia",
  },
  {
    id: "MDC1",
    name: "Manado - Sam Ratulangi International Airport",
    iataCode: "MDC",
    cityName: "Manado",
    countryName: "Indonesia",
  },
  {
    id: "PKU1",
    name: "Pekanbaru - Sultan Syarif Kasim II Airport",
    iataCode: "PKU",
    cityName: "Pekanbaru",
    countryName: "Indonesia",
  },
  {
    id: "LOP1",
    name: "Lombok - Lombok International Airport",
    iataCode: "LOP",
    cityName: "Lombok",
    countryName: "Indonesia",
  },
  {
    id: "SOC1",
    name: "Solo - Adisumarmo International Airport",
    iataCode: "SOC",
    cityName: "Solo",
    countryName: "Indonesia",
  },
  {
    id: "PNK1",
    name: "Pontianak - Supadio International Airport",
    iataCode: "PNK",
    cityName: "Pontianak",
    countryName: "Indonesia",
  },
  {
    id: "AMQ1",
    name: "Ambon - Pattimura Airport",
    iataCode: "AMQ",
    cityName: "Ambon",
    countryName: "Indonesia",
  },

  // Asia Tenggara
  {
    id: "SIN1",
    name: "Singapore - Changi Airport",
    iataCode: "SIN",
    cityName: "Singapore",
    countryName: "Singapore",
  },
  {
    id: "KUL1",
    name: "Kuala Lumpur - International Airport",
    iataCode: "KUL",
    cityName: "Kuala Lumpur",
    countryName: "Malaysia",
  },
  {
    id: "BKK1",
    name: "Bangkok - Suvarnabhumi Airport",
    iataCode: "BKK",
    cityName: "Bangkok",
    countryName: "Thailand",
  },
  {
    id: "DMK1",
    name: "Bangkok - Don Mueang Airport",
    iataCode: "DMK",
    cityName: "Bangkok",
    countryName: "Thailand",
  },
  {
    id: "MNL1",
    name: "Manila - Ninoy Aquino Airport",
    iataCode: "MNL",
    cityName: "Manila",
    countryName: "Philippines",
  },
  {
    id: "HAN1",
    name: "Hanoi - Noi Bai Airport",
    iataCode: "HAN",
    cityName: "Hanoi",
    countryName: "Vietnam",
  },
  {
    id: "SGN1",
    name: "Ho Chi Minh - Tan Son Nhat Airport",
    iataCode: "SGN",
    cityName: "Ho Chi Minh",
    countryName: "Vietnam",
  },
  {
    id: "PNH1",
    name: "Phnom Penh - International Airport",
    iataCode: "PNH",
    cityName: "Phnom Penh",
    countryName: "Cambodia",
  },
  {
    id: "RGN1",
    name: "Yangon - International Airport",
    iataCode: "RGN",
    cityName: "Yangon",
    countryName: "Myanmar",
  },

  // Asia Timur
  {
    id: "HKG1",
    name: "Hong Kong - International Airport",
    iataCode: "HKG",
    cityName: "Hong Kong",
    countryName: "Hong Kong",
  },
  {
    id: "TPE1",
    name: "Taipei - Taoyuan Airport",
    iataCode: "TPE",
    cityName: "Taipei",
    countryName: "Taiwan",
  },
  {
    id: "ICN1",
    name: "Seoul - Incheon Airport",
    iataCode: "ICN",
    cityName: "Seoul",
    countryName: "South Korea",
  },
  {
    id: "NRT1",
    name: "Tokyo - Narita Airport",
    iataCode: "NRT",
    cityName: "Tokyo",
    countryName: "Japan",
  },
  {
    id: "HND1",
    name: "Tokyo - Haneda Airport",
    iataCode: "HND",
    cityName: "Tokyo",
    countryName: "Japan",
  },
  {
    id: "PEK1",
    name: "Beijing - Capital Airport",
    iataCode: "PEK",
    cityName: "Beijing",
    countryName: "China",
  },
  {
    id: "PVG1",
    name: "Shanghai - Pudong Airport",
    iataCode: "PVG",
    cityName: "Shanghai",
    countryName: "China",
  },

  // Timur Tengah
  {
    id: "DXB1",
    name: "Dubai - International Airport",
    iataCode: "DXB",
    cityName: "Dubai",
    countryName: "UAE",
  },
  {
    id: "DOH1",
    name: "Doha - Hamad Airport",
    iataCode: "DOH",
    cityName: "Doha",
    countryName: "Qatar",
  },
  {
    id: "AUH1",
    name: "Abu Dhabi - International Airport",
    iataCode: "AUH",
    cityName: "Abu Dhabi",
    countryName: "UAE",
  },
  {
    id: "JED1",
    name: "Jeddah - King Abdulaziz Airport",
    iataCode: "JED",
    cityName: "Jeddah",
    countryName: "Saudi Arabia",
  },

  // Australia & Oceania
  {
    id: "SYD1",
    name: "Sydney - Kingsford Smith Airport",
    iataCode: "SYD",
    cityName: "Sydney",
    countryName: "Australia",
  },
  {
    id: "MEL1",
    name: "Melbourne - Tullamarine Airport",
    iataCode: "MEL",
    cityName: "Melbourne",
    countryName: "Australia",
  },
  {
    id: "PER1",
    name: "Perth - Airport",
    iataCode: "PER",
    cityName: "Perth",
    countryName: "Australia",
  },
  {
    id: "AKL1",
    name: "Auckland - Airport",
    iataCode: "AKL",
    cityName: "Auckland",
    countryName: "New Zealand",
  },

  // Eropa
  {
    id: "LHR1",
    name: "London - Heathrow Airport",
    iataCode: "LHR",
    cityName: "London",
    countryName: "United Kingdom",
  },
  {
    id: "CDG1",
    name: "Paris - Charles de Gaulle Airport",
    iataCode: "CDG",
    cityName: "Paris",
    countryName: "France",
  },
  {
    id: "AMS1",
    name: "Amsterdam - Schiphol Airport",
    iataCode: "AMS",
    cityName: "Amsterdam",
    countryName: "Netherlands",
  },
  {
    id: "FRA1",
    name: "Frankfurt - Airport",
    iataCode: "FRA",
    cityName: "Frankfurt",
    countryName: "Germany",
  },
  {
    id: "IST1",
    name: "Istanbul - Airport",
    iataCode: "IST",
    cityName: "Istanbul",
    countryName: "Turkey",
  },

  // Amerika
  {
    id: "LAX1",
    name: "Los Angeles - International Airport",
    iataCode: "LAX",
    cityName: "Los Angeles",
    countryName: "USA",
  },
  {
    id: "JFK1",
    name: "New York - JFK Airport",
    iataCode: "JFK",
    cityName: "New York",
    countryName: "USA",
  },
  {
    id: "SFO1",
    name: "San Francisco - International Airport",
    iataCode: "SFO",
    cityName: "San Francisco",
    countryName: "USA",
  },
];

// Fungsi untuk search lokasi dengan fallback
export const searchLocationsWithFallback = (query, amadeusResults = []) => {
  const lowerQuery = query.toLowerCase();

  // Filter dari database lokal
  const localResults = popularLocations.filter((location) => {
    return (
      location.name.toLowerCase().includes(lowerQuery) ||
      location.iataCode.toLowerCase().includes(lowerQuery) ||
      location.cityName.toLowerCase().includes(lowerQuery) ||
      location.countryName.toLowerCase().includes(lowerQuery)
    );
  });

  // Gabungkan hasil Amadeus dengan hasil lokal, hindari duplikat
  const combinedResults = [...amadeusResults];

  localResults.forEach((localLoc) => {
    const isDuplicate = amadeusResults.some(
      (amadLoc) => amadLoc.iataCode === localLoc.iataCode
    );

    if (!isDuplicate) {
      // Format sesuai dengan struktur Amadeus
      combinedResults.push({
        id: localLoc.id,
        name: localLoc.name,
        iataCode: localLoc.iataCode,
        address: {
          cityName: localLoc.cityName,
          countryName: localLoc.countryName,
        },
      });
    }
  });

  // Urutkan berdasarkan relevansi (IATA code match dulu)
  return combinedResults.sort((a, b) => {
    const aCodeMatch = a.iataCode.toLowerCase().startsWith(lowerQuery);
    const bCodeMatch = b.iataCode.toLowerCase().startsWith(lowerQuery);

    if (aCodeMatch && !bCodeMatch) return -1;
    if (!aCodeMatch && bCodeMatch) return 1;
    return 0;
  });
};
